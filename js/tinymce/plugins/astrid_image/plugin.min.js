/**
Плагин Astrid Image
*/

tinymce.PluginManager.add('astrid_image', function(editor) {

	function fOpenDialog()
	{
		return function() {
			editor.focus(true);
			editor.windowManager.open({
				title: "Insert image from store",
				url: '/admin/file/1/',
				width: 800,
				height: fGetHeight()
			});
		};
	}

	function fGetWidth()
	{
		var width = $(window).width() - 20;

		return width;
	}

	function fGetHeight()
	{
		var height = $(window).height() - 20;

		if (height > 750)
		{
			height = 750;
		}
		return height;
	}

	editor.addButton('astrid_image', {
		icon: "browse",
		tooltip: 'Insert image from store',
		onclick: fOpenDialog()
	});

	editor.addMenuItem('image', {
		icon: "browse",
		text: 'Insert image from store',
		onclick: fOpenDialog(),
		context: 'insert',
		prependToContext: true
	});
});